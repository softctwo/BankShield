global:
  smtp_smarthost: 'smtp.bankshield.com:587'
  smtp_from: 'alerts@bankshield.com'
  smtp_auth_username: 'alerts@bankshield.com'
  smtp_auth_password: 'BankShield@2024'
  smtp_require_tls: true
  
  # Slacké…ç½®ï¼ˆå¯é€‰ï¼‰
  slack_api_url: 'https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK'

# è·¯ç”±é…ç½®
route:
  group_by: ['alertname', 'severity', 'service']
  group_wait: 10s
  group_interval: 10s
  repeat_interval: 1h
  receiver: 'bankshield-default'
  routes:
    # å…³é”®å‘Šè­¦è·¯ç”±
    - match:
        severity: critical
      receiver: 'bankshield-critical'
      continue: true
      group_wait: 5s
      group_interval: 5s
      repeat_interval: 30m
    
    # å®‰å…¨å‘Šè­¦è·¯ç”±
    - match:
        type: security
      receiver: 'bankshield-security'
      continue: true
      group_wait: 10s
      group_interval: 10s
      repeat_interval: 15m
    
    # ä¸šåŠ¡å‘Šè­¦è·¯ç”±
    - match:
        type: business
      receiver: 'bankshield-business'
      continue: true
      group_wait: 30s
      group_interval: 1m
      repeat_interval: 2h
    
    # åˆè§„å‘Šè­¦è·¯ç”±
    - match:
        type: compliance
      receiver: 'bankshield-compliance'
      continue: true
      group_wait: 1m
      group_interval: 5m
      repeat_interval: 4h

# æ¥æ”¶å™¨é…ç½®
receivers:
  - name: 'bankshield-default'
    email_configs:
      - to: 'ops@bankshield.com'
        subject: '[BankShield] ç³»ç»Ÿå‘Šè­¦ - {{ .GroupLabels.alertname }}'
        body: |
          {{ range .Alerts }}
          å‘Šè­¦åç§°: {{ .Annotations.summary }}
          æè¿°: {{ .Annotations.description }}
          æ—¶é—´: {{ .StartsAt }}
          æœåŠ¡: {{ .Labels.service }}
          çº§åˆ«: {{ .Labels.severity }}
          {{ end }}
        headers:
          From: 'BankShield Monitoring <alerts@bankshield.com>'
          X-Priority: '3'

  - name: 'bankshield-critical'
    email_configs:
      - to: 'urgent@bankshield.com, oncall@bankshield.com'
        subject: '[CRITICAL] BankShieldç´§æ€¥å‘Šè­¦ - {{ .GroupLabels.alertname }}'
        body: |
          ğŸš¨ CRITICAL ALERT ğŸš¨
          
          {{ range .Alerts }}
          å‘Šè­¦åç§°: {{ .Annotations.summary }}
          æè¿°: {{ .Annotations.description }}
          æ—¶é—´: {{ .StartsAt }}
          æœåŠ¡: {{ .Labels.service }}
          å®ä¾‹: {{ .Labels.instance }}
          çº§åˆ«: {{ .Labels.severity }}
          
          å¤„ç†å»ºè®®:
          1. ç«‹å³æ£€æŸ¥ç›¸å…³æœåŠ¡çŠ¶æ€
          2. æŸ¥çœ‹è¯¦ç»†æ—¥å¿—ä¿¡æ¯
          3. å¿…è¦æ—¶è”ç³»æŠ€æœ¯æ”¯æŒ
          {{ end }}
        headers:
          From: 'BankShield Critical <alerts@bankshield.com>'
          X-Priority: '1'
        require_tls: true
    
    slack_configs:
      - api_url: 'https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK'
        channel: '#bankshield-critical'
        title: 'ğŸš¨ BankShield Critical Alert'
        text: |
          {{ range .Alerts }}
          *{{ .Annotations.summary }}*
          {{ .Annotations.description }}
          Service: {{ .Labels.service }}
          Instance: {{ .Labels.instance }}
          Severity: {{ .Labels.severity }}
          Time: {{ .StartsAt }}
          {{ end }}
        color: 'danger'
        send_resolved: true

  - name: 'bankshield-security'
    email_configs:
      - to: 'security@bankshield.com, ops@bankshield.com'
        subject: '[SECURITY] BankShieldå®‰å…¨å‘Šè­¦ - {{ .GroupLabels.alertname }}'
        body: |
          ğŸ”’ SECURITY ALERT ğŸ”’
          
          {{ range .Alerts }}
          å®‰å…¨å¨èƒ: {{ .Annotations.summary }}
          è¯¦ç»†æè¿°: {{ .Annotations.description }}
          å¨èƒç±»å‹: {{ .Labels.threat_type }}
          æ¥æº: {{ .Labels.source }}
          æ—¶é—´: {{ .StartsAt }}
          çº§åˆ«: {{ .Labels.severity }}
          
          å®‰å…¨å»ºè®®:
          1. ç«‹å³æ£€æŸ¥ç›¸å…³å®‰å…¨ç­–ç•¥
          2. åˆ†æå¨èƒæ¥æºå’Œæ”»å‡»æ¨¡å¼
          3. åŠ å¼ºç›¸å…³é˜²æŠ¤æªæ–½
          4. è®°å½•å®‰å…¨äº‹ä»¶è¯¦æƒ…
          {{ end }}
        headers:
          From: 'BankShield Security <alerts@bankshield.com>'
          X-Priority: '1'
    
    webhook_configs:
      - url: 'http://security-gateway.bankshield.com/api/alerts'
        send_resolved: true
        http_config:
          basic_auth:
            username: 'alertmanager'
            password: 'BankShield@2024'

  - name: 'bankshield-business'
    email_configs:
      - to: 'business@bankshield.com, ops@bankshield.com'
        subject: '[BUSINESS] BankShieldä¸šåŠ¡å‘Šè­¦ - {{ .GroupLabels.alertname }}'
        body: |
          ğŸ“Š BUSINESS ALERT ğŸ“Š
          
          {{ range .Alerts }}
          ä¸šåŠ¡åŠŸèƒ½: {{ .Labels.function }}
          æŒ‡æ ‡: {{ .Labels.metric }}
          æè¿°: {{ .Annotations.description }}
          æ—¶é—´: {{ .StartsAt }}
          çº§åˆ«: {{ .Labels.severity }}
          
          ä¸šåŠ¡å½±å“:
          1. å¯èƒ½å½±å“ç”¨æˆ·ä½“éªŒ
          2. éœ€è¦å…³æ³¨ä¸šåŠ¡æŒ‡æ ‡å˜åŒ–
          3. å¿…è¦æ—¶é€šçŸ¥ç›¸å…³ä¸šåŠ¡éƒ¨é—¨
          {{ end }}
        headers:
          From: 'BankShield Business <alerts@bankshield.com>'
          X-Priority: '2'

  - name: 'bankshield-compliance'
    email_configs:
      - to: 'compliance@bankshield.com, security@bankshield.com'
        subject: '[COMPLIANCE] BankShieldåˆè§„å‘Šè­¦ - {{ .GroupLabels.alertname }}'
        body: |
          ğŸ“‹ COMPLIANCE ALERT ğŸ“‹
          
          {{ range .Alerts }}
          åˆè§„é¡¹: {{ .Annotations.summary }}
          è¯¦ç»†æè¿°: {{ .Annotations.description }}
          åˆè§„æ ‡å‡†: {{ .Labels.standard }}
          æ—¶é—´: {{ .StartsAt }}
          çº§åˆ«: {{ .Labels.severity }}
          
          åˆè§„è¦æ±‚:
          1. ç«‹å³æ£€æŸ¥åˆè§„çŠ¶æ€
          2. è¯„ä¼°åˆè§„é£é™©
          3. åˆ¶å®šæ•´æ”¹è®¡åˆ’
          4. è®°å½•åˆè§„é—®é¢˜
          5. è·Ÿè¸ªæ•´æ”¹è¿›åº¦
          {{ end }}
        headers:
          From: 'BankShield Compliance <alerts@bankshield.com>'
          X-Priority: '2'

# æŠ‘åˆ¶è§„åˆ™
inhibit_rules:
  - source_match:
      severity: 'critical'
    target_match:
      severity: 'warning'
    equal: ['alertname', 'service', 'instance']

  - source_match:
      severity: 'critical'
      type: 'system'
    target_match_re:
      type: '.*'
    equal: ['service', 'instance']

# é™é»˜é…ç½®æ¨¡æ¿ï¼ˆç”¨äºç»´æŠ¤æ¨¡å¼ï¼‰
templates:
  - '/etc/alertmanager/templates/*.tmpl'