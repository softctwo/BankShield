# BankShield vs DSGP PRD 差距分析报告

## 📋 对比概述

### 现有BankShield系统状态
**已完成**:
- ✅ 基础用户/角色/部门/菜单管理
- ✅ 统一认证与JWT授权
- ✅ 基础数据加密工具（SM2/SM3/SM4）
- ✅ 基础数据脱敏工具
- ✅ 简单的审计日志表结构
- ✅ 前后端分离架构
- ✅ 基础的数据库和缓存配置

**缺失功能**（按PRD要求）：
- ❌ 数据资产发现引擎
- ❌ 智能分类分级（C1-C4）
- ❌ 策略全生命周期管理
- ❌ 实时脱敏控制引擎
- ❌ 数据流转监控
- ❌ 风险行为识别
- ❌ 区块链存证
- ❌ 国密算法深度集成
- ❌ 微服务架构
- ❌ 等保三级安全特性

---

## 🔍 详细差距分析

### 1. 数据资产发现与分级分类模块

#### PRD要求
- 支持Oracle、MySQL、PostgreSQL、GoldenDB、TiDB等数据库
- 支持NAS、HDFS、S3对象存储
- 支持Hive、HBase、Kafka等大数据平台
- 全量扫描、增量扫描（CDC）、定时扫描
- 预置金融行业模板（JR/T 0197-2020、JR/T 0171-2020）
- C1-C4四级分类（机构内部信息、一般个人信息、敏感个人信息、极敏感信息）
- 正则匹配、关键词库、BERT机器学习（F1-score≥0.92）
- 数据血缘分析、字段级流转图谱
- 数据资产地图可视化

#### 现有系统
- 仅有基础的数据库表结构
- 无自动化扫描能力
- 无智能识别规则
- 无数据血缘功能

#### 差距等级：🔴 **重大缺失**

#### 开发工作量估计
- 数据资产扫描引擎：40人天
- 智能识别规则引擎：30人天
- 数据血缘分析：25人天
- 资产地图可视化：20人天
- **合计：115人天**

---

### 2. 数据安全策略管理中心

#### PRD要求
- 策略全生命周期：配置态、测试态、生效态、下线态
- 可视化策略编排界面
- Git-like版本控制
- 策略仿真沙箱（A/B测试）
- 实时推送至执行引擎（延迟<3秒）
- 30天冷冻期机制
- 策略类型：
  - ACL访问控制（RBAC+ABAC）
  - 动态脱敏（7种国密算法）
  - 静态脱敏（ETL任务调度）
  - 数据加密（列级/表级/文件级）
  - 数据水印（明水印+暗水印）

#### 现有系统
- 仅有基础的用户角色权限
- 无策略管理功能
- 无版本控制
- 无沙箱测试

#### 差距等级：🔴 **重大缺失**

#### 开发工作量估计
- 策略配置中心：35人天
- 版本管理系统：15人天
- 策略仿真沙箱：25人天
- 配置中心推送：10人天
- 各类策略引擎实现：60人天
- **合计：145人天**

---

### 3. 数据访问与脱敏控制

#### PRD要求
- 三级拦截纵深：
  - 数据库透明网关（Proxy）
  - 应用层JDBC/SDK代理
  - API网关插件（Lua）
- 策略匹配延迟<100ms
- 单节点吞吐量≥5000 QPS
- Fail-Closed模式
- 脱敏执行逻辑：身份属性查询 → 策略匹配 → 冲突仲裁 → 国密加密卡处理 → 结果返回
- 静态脱敏：全量/增量任务调度、保真度评估
- 7种国密算法：SM4加密、掩码、哈希、取整、置空、K-匿名、差分隐私

#### 现有系统
- 仅有基础加密工具类
- 无实时拦截引擎
- 无脱敏策略执行
- 无静态脱敏

#### 差距等级：🔴 **重大缺失**

#### 开发工作量估计
- 数据库代理网关：50人天
- 应用层SDK：30人天
- API网关插件：20人天
- 脱敏策略引擎：40人天
- 静态脱敏子系统：35人天
- **合计：175人天**

---

### 4. 数据流转监控与审计

#### PRD要求
- 监控范围：
  - 内部流转（东西向）：Hive→Spark等
  - 外部出口（南北向）：API网关、邮件、企业微信、USB、打印
- 风险规则：
  - 单日导出C3+数据>10万条
  - 非工作时间访问C4数据
  - 向白名单外IP发送数据
  - 跨安全域传输未脱敏数据
- UBA用户行为分析（隔离森林算法）
- 审计日志：7W要素记录
- 存储策略：ES（30天热数据）→ OSS（30-90天温数据）→ 蓝光（冷数据）
- 区块链存证：SM3哈希上链
- 查询性能：10亿级日志<5秒

#### 现有系统
- 仅有基础审计日志表（audit_log）
- 无实时监控
- 无风险识别
- 无区块链存证

#### 差距等级：🔴 **重大缺失**

#### 开发工作量估计
- 数据流转监控：40人天
- 风险规则引擎：30人天
- UBA行为分析：35人天
- 审计日志系统：30人天
- 区块链存证：25人天
- **合计：160人天**

---

### 5. 安全风险态势感知与报表

#### PRD要求
- 高管视图：风险指数、告警趋势、合规达标率
- 策略员视图：策略热力图、命中TOP10、异常清单
- 审计员视图：权利响应时效、数据出境统计、整改完成率
- 预置报表：
  - 个人信息查询日志报表（周报）
  - 数据出境传输月报
  - 策略执行合规率报告（季报）
- 报表订阅：定时推送PDF/加密Excel
- 支持投屏展示

#### 现有系统
- 仅有基础Dashboard概念
- 无报表系统
- 无风险指数计算

#### 差距等级：🟡 **部分缺失**

#### 开发工作量估计
- 实时监控Dashboard：30人天
- 报表引擎：40人天
- 报表模板开发：25人天
- 推送订阅系统：15人天
- **合计：110人天**

---

### 6. 系统集成需求

#### PRD要求
- 统一身份认证平台（IAM）：OAuth 2.0 + SCIM 2.0
- 核心银行系统（Core Banking）：JDBC代理 + gRPC
- 信贷管理系统（CMS）：Java/Python SDK
- 数据仓库（EDW）：元数据API + Fluentd日志
- 大数据平台（Hadoop）：Hive Hook + Spark Listener
- API网关：Lua插件
- 运维监控（Zabbix）：Sender API
- 密钥管理系统（KMS）：国密SSL通道
- 区块链存证：Kafka + Fabric SDK

#### 现有系统
- 仅完成基础用户管理
- 无任何外部系统集成

#### 差距等级：🔴 **重大缺失**

#### 开发工作量估计
- IAM集成：20人天
- 核心系统代理：40人天
- CMS SDK：25人天
- 数据仓库对接：30人天
- 大数据平台插件：35人天
- API网关插件：15人天
- KMS集成：15人天
- 区块链集成：25人天
- **合计：205人天**

---

### 7. 国密算法深度集成

#### PRD要求
- 全面使用SM2/SM3/SM4
- 禁止使用MD5、SHA1、RSA等国际算法
- 支持国密SSL证书（行内CA签发）
- 支持国密加密卡（信创环境）
- 静态加密：SM4
- 数字签名：SM2
- 哈希算法：SM3

#### 现有系统
- 已有基础SM2/SM3/SM4工具类
- 但尚未全面替换国际算法
- 无国密SSL支持
- 无国密加密卡集成

#### 差距等级：🟢 **部分已具备，需深化**

#### 开发工作量估计
- 算法全面替换：25人天
- 国密SSL改造：20人天
- 加密卡集成：30人天
- **合计：75人天**

---

### 8. 微服务架构改造

#### PRD要求
- Spring Cloud Alibaba技术栈
- Nacos注册与发现
- 微服务拆分：
  - bankshield-gateway（API网关）
  - bankshield-auth（认证服务）
  - bankshield-api（核心服务）
  - bankshield-policy（策略引擎）
  - bankshield-audit（审计服务）
  - bankshield-monitor（监控服务）
  - bankshield-encrypt（加密服务）
  - bankshield-discovery（服务注册中心）
- 网关支持Lua插件
- 配置中心统一管理

#### 现有系统
- 单体Spring Boot应用
- 无微服务架构
- 无服务注册与发现
- 无API网关

#### 差距等级：🔴 **架构级缺失**

#### 开发工作量估计
- 服务拆分与重构：80人天
- 网关开发：40人天
- 配置中心：20人天
- 服务治理：30人天
- **合计：170人天**

---

### 9. 等保三级安全特性

#### PRD要求
- **三权分立**：
  - 系统管理员：用户/角色管理、系统监控、备份恢复
  - 安全策略员：策略配置、密钥管理、风险规则
  - 合规审计员：日志查询、报表生成、策略监控
  - 角色互斥，禁止同一人同时拥有多个角色
- **Fail-Closed模式**：引擎故障时拒绝所有访问
- **通信安全**：TLS 1.3，国密SSL
- **代码安全**：
  - SonarQube扫描（高危漏洞=0）
  - 黑盒渗透测试（高危漏洞=0）
- **审计日志**：不可篡改、不可删除

#### 现有系统
- 仅有基础用户角色
- 无角色互斥机制
- 无Fail-Closed设计
- 无TLS 1.3强制

#### 差距等级：🔴 **安全级缺失**

#### 开发工作量估计
- 三权分立改造：40人天
- Fail-Closed机制：15人天
- 安全加固：30人天
- 渗透测试与修复：40人天
- **合计：125人天**

---

## 📈 总工作量统计

### 按模块统计

| 模块 | 工作量（人天） | 占比 |
|------|---------------|------|
| 数据资产发现与分级分类 | 115 | 13% |
| 策略管理中心 | 145 | 17% |
| 脱敏控制引擎 | 175 | 20% |
| 监控与审计 | 160 | 19% |
| 态势感知与报表 | 110 | 13% |
| 系统集成 | 205 | 24% |
| 国密算法深化 | 75 | 9% |
| 微服务架构 | 170 | 20% |
| 等保三级安全 | 125 | 15% |
| **合计** | **1280人天** | **152%** |

> **说明**：部分工作并行开展，实际人天约852

---

## 🎯 开发优先级建议

### P0 紧急（影响系统核心安全）
1. 等保三级安全特性（三权分立、Fail-Closed）- 125人天
2. 国密算法深度集成 - 75人天
3. 数据资产发现与分级分类 - 115人天

### P1 高优先级（核心功能缺失）
4. 策略管理中心 - 145人天
5. 实时脱敏控制引擎 - 175人天
6. 数据流转监控与审计 - 160人天

### P2 中优先级（增强功能）
7. 态势感知与报表 - 110人天
8. 微服务架构改造 - 170人天

### P3 低优先级（集成优化）
9. 系统集成 - 205人天

---

## 🚀 版本规划建议

### V1.1（3个月内）- 基础安全能力
**目标**：满足最基本的安全合规要求
**主要功能**：
- 三权分立机制
- 国密算法全面替换
- 基础数据分类分级（C1-C4）
- 基础策略管理
- 基础审计日志
- 预计工作量：460人天

### V1.2（6个月内）- 核心功能完善
**目标**：具备完整的数据安全管控能力
**主要功能**：
- 数据资产发现引擎
- 策略仿真沙箱
- 实时脱敏控制
- 数据流转监控
- 风险行为识别
- 预计工作量：620人天

### V1.3（9个月内）- 高级特性
**目标**：完善用户体验和高级功能
**主要功能**：
- 态势感知Dashboard
- 报表引擎与订阅
- 区块链存证
- 微服务架构完成
- 系统集成
- 预计工作量：600人天

### V2.0（12个月内）- 企业级能力
**目标**：满足全行3万员工、5000外包、200家合作机构使用
**主要功能**：
- 性能优化（5000 QPS）
- 大数据平台深度集成
- AI风险检测模型
- 等保三级测评通过
- 预计工作量：200人天

---

## 💰 资源需求

### 人力资源
- **核心开发团队**：8-10人（Java高级开发、前端、算法、安全专家）
- **测试团队**：3-4人（性能测试、安全测试）
- **产品经理**：2人
- **项目经理**：1人

### 硬件资源
- **生产环境**：满足99.99%可用性
  - 应用服务器：16台（8核32G）
  - 数据库：MySQL主从 + Redis集群 + Elasticsearch集群
  - 存储：100TB NAS + 对象存储
- **测试环境**：
  - 应用服务器：4台
  - 数据库：2台

---

## ⚠️ 风险评估

### 高风险项
1. **监管合规风险**：未按时完成等保测评，可能面临监管处罚
2. **数据泄露风险**：脱敏控制引擎不完善，可能导致敏感数据泄露
3. **系统稳定性风险**：微服务架构改造不彻底，可能影响业务连续性

### 中风险项
1. **性能风险**：初期设计未考虑大规模并发，后期优化成本高
2. **集成风险**：对接系统多，接口改造工作量大

### 低风险项
1. **用户体验**：界面交互细节，可后续迭代优化

---

## 📝 下一步行动

### 立即行动（本周）
1. 🔥 启动P0级开发：等保三级安全特性
2. 🔥 搭建开发分支管理规范（Git Flow）
3. 🔥 制定详细技术方案和接口文档
4. 🔥 申请测试环境和硬件资源

### 短期行动（本月）
1. 完成国密算法全面替换
2. 实现三权分立机制
3. 搭建基础数据分类分级功能
4. 集成统一身份认证平台（IAM）

### 中期行动（3个月）
1. 完成V1.1版本所有功能
2. 通过内部安全测试
3. 启动监管报备流程
4. 开展用户培训

---

**报告生成时间**：2025-12-23
**分析人**：BankShield开发团队
**状态**：待评审
