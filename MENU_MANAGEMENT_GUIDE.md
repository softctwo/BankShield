# BankShield 菜单管理功能使用指南

## 功能概述

菜单管理功能为BankShield系统提供了完整的导航系统管理功能，支持：

- 树形结构的菜单展示
- 多级菜单管理（支持无限层级）
- 图标选择功能
- 路由路径配置
- 组件路径配置
- 权限标识管理
- 菜单类型区分（目录/菜单/按钮）
- 排序管理
- 状态管理（启用/禁用）

## 文件结构

### 后端文件

```
bankshield-api/
├── src/main/java/com/bankshield/api/
│   ├── controller/MenuController.java     # 菜单管理控制器
│   ├── service/MenuService.java           # 菜单管理服务
│   ├── mapper/MenuMapper.java             # 菜单数据访问层
│   └── entity/Menu.java                   # 菜单实体类（已更新）
```

### 前端文件

```
bankshield-ui/
├── src/
│   ├── api/menu.ts                        # 菜单管理API
│   ├── types/menu.d.ts                    # 菜单类型定义
│   ├── views/system/menu/index.vue        # 菜单管理页面
│   └── components/IconSelect/index.vue    # 图标选择器组件
```

### 数据库文件

```
sql/menu_init.sql                         # 菜单初始化数据
```

## 使用说明

### 1. 数据库初始化

执行SQL脚本初始化菜单数据：

```sql
mysql -u root -p bankshield < sql/menu_init.sql
```

### 2. 访问菜单管理

1. 登录系统
2. 进入"系统管理"模块
3. 点击"菜单管理"菜单

### 3. 功能操作

#### 新增菜单
- 点击"新增菜单"按钮
- 填写菜单信息
- 选择上级菜单（可选）
- 选择图标
- 设置排序和状态
- 点击"确定"保存

#### 编辑菜单
- 点击对应菜单行的"编辑"按钮
- 修改菜单信息
- 点击"确定"保存

#### 删除菜单
- 点击对应菜单行的"删除"按钮
- 确认删除操作
- 注意：存在子菜单的菜单不能被删除

#### 添加子菜单
- 点击对应菜单行的"添加"按钮
- 自动设置上级菜单
- 填写子菜单信息
- 点击"确定"保存

### 4. 字段说明

| 字段名 | 说明 | 必填 | 备注 |
|--------|------|------|------|
| 上级菜单 | 父级菜单 | 否 | 顶级菜单可不选 |
| 菜单名称 | 显示名称 | 是 | 长度2-50字符 |
| 菜单编码 | 唯一标识 | 是 | 长度2-50字符，不可重复 |
| 菜单类型 | 目录/菜单/按钮 | 是 | 目录：容器，菜单：页面，按钮：操作 |
| 图标 | Element Plus图标 | 否 | 目录和菜单可用 |
| 路由路径 | Vue Router路径 | 否 | 菜单类型必填 |
| 组件路径 | Vue组件路径 | 否 | 菜单类型必填 |
| 权限标识 | 权限控制标识 | 否 | 按钮类型必填 |
| 排序 | 显示顺序 | 是 | 数字越大越靠前 |
| 状态 | 启用/禁用 | 是 | 控制菜单是否可用 |

## 开发说明

### 后端API

#### 获取菜单树
```
GET /api/menu/tree
```

#### 获取菜单列表
```
GET /api/menu/list
```

#### 获取菜单详情
```
GET /api/menu/{id}
```

#### 创建菜单
```
POST /api/menu
```

#### 更新菜单
```
PUT /api/menu/{id}
```

#### 删除菜单
```
DELETE /api/menu/{id}
```

#### 获取父级菜单
```
GET /api/menu/parent-list
```

### 前端组件

#### 图标选择器
```vue
<IconSelect v-model="menuForm.icon" placeholder="请选择图标" />
```

#### 树形选择器
```vue
<el-tree-select
  v-model="menuForm.parentId"
  :data="parentMenuOptions"
  :props="{ label: 'menuName', value: 'id', children: 'children' }"
  placeholder="请选择上级菜单"
  clearable
  check-strictly
/>
```

## 注意事项

1. **菜单编码唯一性**：每个菜单的编码必须唯一，不能重复
2. **删除限制**：存在子菜单的父菜单不能被删除
3. **类型限制**：
   - 目录类型：不能有路由路径和组件路径
   - 菜单类型：必须有路由路径，组件路径可选
   - 按钮类型：不需要路由和组件路径，但建议设置权限标识
4. **图标使用**：只有目录和菜单类型可以设置图标
5. **排序规则**：数字越大，菜单显示越靠前
6. **状态控制**：禁用的菜单不会在导航中显示

## 扩展功能

### 角色权限关联

菜单管理可以与角色权限系统关联，通过权限标识字段控制不同角色的菜单访问权限。

### 动态路由

系统可以根据菜单配置动态生成Vue Router路由配置，实现完全的动态路由管理。

### 国际化支持

可以通过扩展菜单实体，添加多语言字段支持国际化。

## 故障排除

### 常见问题

1. **图标不显示**
   - 检查图标名称是否正确
   - 确认Element Plus图标库已正确引入

2. **菜单树不展开**
   - 检查后端返回的数据结构
   - 确认children字段正确设置

3. **无法删除菜单**
   - 检查是否有子菜单
   - 查看后端错误日志

4. **表单验证失败**
   - 检查必填字段是否填写
   - 确认字段格式正确

## 技术支持

如有问题，请联系开发团队或提交Issue。